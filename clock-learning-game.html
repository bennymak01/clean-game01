<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-62XEZ7NH21"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-62XEZ7NH21');
  </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn to Read Time | Â≠∏ÁøíÁúãÊôÇÈêò</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }

        .container {
            background: white;
            border-radius: 30px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .header h2 {
            color: #e53e3e;
            font-size: 1.5em;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
        }

        .welcome-logo {
            font-size: 8em;
            margin: 20px 0;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .language-select {
            margin: 30px 0;
        }

        .language-select h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .lang-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .lang-btn {
            padding: 15px 40px;
            border: 4px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .lang-btn:hover {
            transform: scale(1.05);
        }

        .lang-btn.selected {
            background: #667eea;
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .start-btn {
            margin-top: 30px;
            padding: 20px 60px;
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(72, 187, 120, 0.4);
            transition: all 0.3s;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(72, 187, 120, 0.5);
        }

        /* Menu Screen */
        .menu-screen {
            display: none;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #2d3748;
        }

        .stat-label {
            font-size: 0.9em;
            color: #4a5568;
            margin-top: 5px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .menu-card {
            padding: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .menu-card.locked {
            background: #cbd5e0;
            cursor: not-allowed;
            color: #718096;
        }

        .menu-card .icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .lock-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5em;
        }

        .unlock-cost {
            font-size: 0.9em;
            margin-top: 5px;
            color: #ffd700;
        }

        /* Instructions Screen */
        .instructions-screen {
            display: none;
        }

        .instruction-content {
            background: #edf2f7;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .instruction-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .instruction-item .title {
            font-size: 1.2em;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .instruction-item .desc {
            color: #4a5568;
            line-height: 1.5;
        }

        /* Game Screen */
        .game-screen {
            display: none;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background: #edf2f7;
            padding: 15px;
            border-radius: 15px;
        }

        .timer {
            font-size: 1.8em;
            font-weight: bold;
            color: #e53e3e;
            min-width: 100px;
        }

        .timer.warning {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .level-info {
            text-align: center;
        }

        .level-text {
            font-size: 1.3em;
            font-weight: bold;
            color: #2d3748;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78 0%, #38a169 100%);
            transition: width 0.3s;
        }

        .clock-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 30px auto;
            background: white;
            border-radius: 50%;
            border: 10px solid #e53e3e;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .clock-container.style-digital {
            border: 10px solid #3182ce;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .clock-container.style-colorful {
            border: 10px solid #ffd700;
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 50%, #ffe66d 100%);
        }

        .clock-container.style-modern {
            border: 10px solid #2d3748;
            background: linear-gradient(135deg, #434343 0%, #000000 100%);
        }

        .clock-face {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .clock-center {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #2d3748;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }

        .number {
            position: absolute;
            font-size: 1.5em;
            font-weight: bold;
            color: #2d3748;
        }

        .clock-container.style-colorful .number {
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .clock-container.style-modern .number {
            color: #00ff00;
        }

        .hour-hand, .minute-hand {
            position: absolute;
            background: #2d3748;
            transform-origin: bottom center;
            bottom: 50%;
            left: 50%;
            border-radius: 10px;
        }

        .hour-hand {
            width: 8px;
            height: 80px;
            margin-left: -4px;
            background: #e53e3e;
            z-index: 3;
        }

        .minute-hand {
            width: 6px;
            height: 110px;
            margin-left: -3px;
            background: #3182ce;
            z-index: 2;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .option-btn {
            padding: 20px;
            background: #e2e8f0;
            border: 4px solid transparent;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-btn:hover {
            background: #cbd5e0;
            transform: scale(1.05);
        }

        .option-btn.correct {
            background: #48bb78;
            color: white;
            border-color: #2f855a;
            animation: correctAnswer 0.5s;
        }

        .option-btn.wrong {
            background: #fc8181;
            color: white;
            border-color: #e53e3e;
            animation: wrongAnswer 0.5s;
        }

        @keyframes correctAnswer {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes wrongAnswer {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .back-btn {
            padding: 12px 25px;
            background: #4299e1;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        /* Celebration Overlay */
        .celebration-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .celebration-overlay.active {
            display: flex;
        }

        .celebration-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            animation: celebrationPop 0.5s;
        }

        @keyframes celebrationPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .celebration-emoji {
            font-size: 8em;
            margin: 20px 0;
        }

        .celebration-text {
            font-size: 2em;
            font-weight: bold;
            color: #2d3748;
            margin: 20px 0;
        }

        .celebration-stats {
            font-size: 1.3em;
            color: #4a5568;
            margin: 15px 0;
        }

        .reward-earned {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: bold;
            color: #2d3748;
            margin: 20px 0;
            display: inline-block;
        }

        .continue-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ffd700;
            position: absolute;
            animation: confettiFall 3s linear;
        }

        @keyframes confettiFall {
            0% { top: -10%; transform: rotate(0deg); }
            100% { top: 100%; transform: rotate(720deg); }
        }

        .tick {
            position: absolute;
            width: 2px;
            height: 10px;
            background: #a0aec0;
            left: 50%;
            margin-left: -1px;
            transform-origin: center 140px;
        }

        .tick.major {
            width: 3px;
            height: 15px;
            background: #4a5568;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .instruction {
            background: #bee3f8;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2em;
            color: #2c5282;
            margin-bottom: 20px;
        }

        /* Panda Character */
        .panda-container {
            position: fixed;
            bottom: 80px;
            right: 30px;
            z-index: 999;
        }

        .panda {
            font-size: 5em;
            transition: all 0.3s;
            cursor: pointer;
            filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
        }

        .panda.happy {
            animation: pandaJump 0.6s;
        }

        .panda.sad {
            animation: pandaShake 0.6s;
        }

        .panda.thinking {
            animation: pandaThink 2s infinite;
        }

        .panda.celebrate {
            animation: pandaSpin 1s;
        }

        @keyframes pandaJump {
            0%, 100% { transform: translateY(0) scale(1) rotate(0deg); }
            50% { transform: translateY(-40px) scale(1.3) rotate(360deg); }
        }

        @keyframes pandaShake {
            0%, 100% { transform: rotate(0deg) scale(1); }
            10%, 30%, 50%, 70%, 90% { transform: rotate(-20deg) scale(1.1); }
            20%, 40%, 60%, 80% { transform: rotate(20deg) scale(1.1); }
        }

        @keyframes pandaThink {
            0%, 100% { transform: rotate(-3deg); }
            50% { transform: rotate(3deg); }
        }

        @keyframes pandaSpin {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.5); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .panda-speech {
            position: absolute;
            bottom: 110%;
            right: -20px;
            background: white;
            padding: 12px 20px;
            border-radius: 20px;
            margin-bottom: 10px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            font-size: 0.3em;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: bold;
            color: #2d3748;
            min-width: 150px;
            text-align: center;
        }

        .panda-speech.show {
            opacity: 1;
        }

        .panda-speech::after {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 30px;
            width: 0;
            height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-top: 12px solid white;
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            color: #718096;
            font-size: 1em;
        }

        .footer .heart {
            color: #e53e3e;
            display: inline-block;
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            10%, 30% { transform: scale(1.2); }
            20%, 40% { transform: scale(1); }
        }

        .footer .inspired-by {
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <!-- Panda Character -->
    <div class="panda-container" id="pandaContainer">
        <div class="panda-speech" id="pandaSpeech"></div>
        <div class="panda thinking" id="panda">üêº</div>
    </div>

    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="screen active">
            <div class="header">
                <h1 id="welcomeTitle">Learn to Read Time</h1>
                <h2 id="welcomeSubtitle">Â≠∏ÁøíÁúãÊôÇÈêò</h2>
            </div>
            
            <div class="welcome-logo">üïê</div>
            
            <div class="language-select">
                <h3 id="selectLanguage">Select Language / ÈÅ∏ÊìáË™ûË®Ä</h3>
                <div class="lang-buttons">
                    <button class="lang-btn selected" onclick="selectLanguage('en')">
                        English üá¨üáß
                    </button>
                    <button class="lang-btn" onclick="selectLanguage('zh')">
                        ‰∏≠Êñá üáπüáº
                    </button>
                </div>
            </div>

            <button class="start-btn" onclick="showInstructions()">
                <span id="startGameBtn">START GAME</span>
            </button>

            <div class="footer">
                Inspired with <span class="heart">‚ù§Ô∏è</span> by <span class="inspired-by">Fung Fung 2D</span>
            </div>
        </div>

        <!-- Instructions Screen -->
        <div id="instructionsScreen" class="screen instructions-screen">
            <div class="header">
                <h1 id="instructionsTitle">How to Play</h1>
            </div>

            <div class="instruction-content">
                <div class="instruction-item">
                    <div class="title">üéØ <span id="inst1Title">Choose the Correct Time</span></div>
                    <div class="desc" id="inst1Desc">Look at the clock and select the correct time from 4 options</div>
                </div>

                <div class="instruction-item">
                    <div class="title">‚è∞ <span id="inst2Title">Beat the Timer</span></div>
                    <div class="desc" id="inst2Desc">Answer as many questions as you can before time runs out!</div>
                </div>

                <div class="instruction-item">
                    <div class="title">üåü <span id="inst3Title">Earn Credits</span></div>
                    <div class="desc" id="inst3Desc">Get 10 credits for each correct answer. Use credits to unlock new clock styles!</div>
                </div>

                <div class="instruction-item">
                    <div class="title">üèÜ <span id="inst4Title">Level Up</span></div>
                    <div class="desc" id="inst4Desc">Complete 10 questions to finish a level and earn bonus credits!</div>
                </div>

                <div class="instruction-item">
                    <div class="title">üêº <span id="inst5Title">Panda Friend</span></div>
                    <div class="desc" id="inst5Desc">Watch the panda! It celebrates when you're correct and encourages you when wrong!</div>
                </div>
            </div>

            <button class="start-btn" onclick="showMenu()">
                <span id="continueBtn">CONTINUE</span>
            </button>

            <div class="footer">
                Inspired with <span class="heart">‚ù§Ô∏è</span> by <span class="inspired-by">Fung Fung 2D</span>
            </div>
        </div>

        <!-- Menu Screen -->
        <div id="menuScreen" class="screen menu-screen">
            <div class="header">
                <h1 id="menuTitle">Main Menu</h1>
            </div>

            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalCredits">0</div>
                    <div class="stat-label" id="creditsLabel">Credits</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="currentLevel">1</div>
                    <div class="stat-label" id="levelLabel">Level</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="highScore">0</div>
                    <div class="stat-label" id="scoreLabel">Best Score</div>
                </div>
            </div>

            <div class="menu-grid">
                <button class="menu-card" onclick="startGame('classic')">
                    <div class="icon">üïê</div>
                    <div id="classicClock">Classic Clock</div>
                </button>

                <button class="menu-card locked" id="digitalCard" onclick="unlockStyle('digital', 50)">
                    <div class="lock-icon">üîí</div>
                    <div class="icon">‚è∞</div>
                    <div id="digitalClock">Digital Clock</div>
                    <div class="unlock-cost">üåü 50 credits</div>
                </button>

                <button class="menu-card locked" id="colorfulCard" onclick="unlockStyle('colorful', 100)">
                    <div class="lock-icon">üîí</div>
                    <div class="icon">üé®</div>
                    <div id="colorfulClock">Colorful Clock</div>
                    <div class="unlock-cost">üåü 100 credits</div>
                </button>

                <button class="menu-card locked" id="modernCard" onclick="unlockStyle('modern', 150)">
                    <div class="lock-icon">üîí</div>
                    <div class="icon">üåô</div>
                    <div id="modernClock">Modern Clock</div>
                    <div class="unlock-cost">üåü 150 credits</div>
                </button>
            </div>

            <button class="back-btn" onclick="showWelcome()">
                ‚Üê <span id="backToWelcome">Back to Welcome</span>
            </button>

            <div class="footer">
                Inspired with <span class="heart">‚ù§Ô∏è</span> by <span class="inspired-by">Fung Fung 2D</span>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen game-screen">
            <div class="game-header">
                <div class="timer" id="gameTimer">60</div>
                <div class="level-info">
                    <div class="level-text" id="gameLevelText">Level 1</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div style="font-size: 0.9em; color: #4a5568;" id="questionCounter">0/10</div>
                </div>
                <div class="stat-value" id="gameCredits">0</div>
            </div>

            <div class="instruction" id="gameInstruction">
                Please choose the correct time
            </div>

            <div class="clock-container" id="gameClock">
                <div class="clock-face" id="gameClockFace"></div>
            </div>

            <div class="quiz-options" id="gameOptions"></div>

            <button class="back-btn" onclick="endGame()">
                ‚Üê <span id="endGameBtn">End Game</span>
            </button>

            <div class="footer">
                Inspired with <span class="heart">‚ù§Ô∏è</span> by <span class="inspired-by">Fung Fung 2D</span>
            </div>
        </div>
    </div>

    <!-- Celebration Overlay -->
    <div class="celebration-overlay" id="celebrationOverlay">
        <div class="celebration-content">
            <div class="celebration-emoji" id="celebrationEmoji">üéâ</div>
            <div class="celebration-text" id="celebrationText">Level Complete!</div>
            <div class="celebration-stats" id="celebrationStats">
                You answered 10/10 questions correctly!
            </div>
            <div class="reward-earned" id="rewardEarned">
                +100 Credits Earned! üåü
            </div>
            <button class="continue-btn" onclick="closeCelebration()">
                <span id="celebrationContinue">CONTINUE</span>
            </button>
        </div>
    </div>

    <script>
        // Game State
        let currentLanguage = 'en';
        let playerCredits = 0;
        let playerLevel = 1;
        let playerHighScore = 0;
        let currentStyle = 'classic';
        let unlockedStyles = ['classic'];
        
        // Game Session State
        let gameTimer = 60;
        let gameTimerInterval = null;
        let currentQuestions = 0;
        let correctAnswers = 0;
        let sessionCredits = 0;
        let currentAnswer = '';

        // Panda State
        let pandaSpeechTimeout = null;

        // Audio Context
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        // Sound Effects
        function playSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            if (type === 'correct') {
                oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
                oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } else if (type === 'wrong') {
                oscillator.frequency.setValueAtTime(200, audioContext.currentTime);
                oscillator.frequency.setValueAtTime(100, audioContext.currentTime + 0.2);
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.3);
            } else if (type === 'celebration') {
                for (let i = 0; i < 5; i++) {
                    const osc = audioContext.createOscillator();
                    const gain = audioContext.createGain();
                    osc.connect(gain);
                    gain.connect(audioContext.destination);
                    
                    const frequencies = [523.25, 659.25, 783.99, 1046.50, 1318.51];
                    osc.frequency.setValueAtTime(frequencies[i], audioContext.currentTime + i * 0.1);
                    gain.gain.setValueAtTime(0.2, audioContext.currentTime + i * 0.1);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i * 0.1 + 0.3);
                    osc.start(audioContext.currentTime + i * 0.1);
                    osc.stop(audioContext.currentTime + i * 0.1 + 0.3);
                }
            } else if (type === 'unlock') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(880, audioContext.currentTime + 0.5);
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            }
        }

        // Panda Functions
        const pandaMessages = {
            correct: {
                en: ['Great job! üåü', 'Excellent! üéâ', 'Perfect! ‚ú®', 'Amazing! üèÜ', 'You got it! üëè'],
                zh: ['ÂÅöÂæóÂ•ΩÔºÅüåü', 'Â§™Ê£í‰∫ÜÔºÅüéâ', 'ÂÆåÁæéÔºÅ‚ú®', 'Âé≤ÂÆ≥ÔºÅüèÜ', 'Á≠îÂ∞ç‰∫ÜÔºÅüëè']
            },
            wrong: {
                en: ['Try again! üí™', 'Keep going! üåà', 'You can do it! ‚≠ê', 'Almost there! üéØ', 'Don\'t give up! üöÄ'],
                zh: ['ÂÜçË©¶‰∏ÄÊ¨°ÔºÅüí™', 'ÁπºÁ∫åÂä†Ê≤πÔºÅüåà', '‰Ω†ÂèØ‰ª•ÁöÑÔºÅ‚≠ê', 'Â∑Æ‰∏ÄÈªû‰∫ÜÔºÅüéØ', '‰∏çË¶ÅÊîæÊ£ÑÔºÅüöÄ']
            },
            start: {
                en: ['Let\'s do this! üéÆ', 'Ready? Go! üèÅ', 'Good luck! üçÄ', 'You can do it! üí´'],
                zh: ['ÈñãÂßãÂêßÔºÅüéÆ', 'Ê∫ñÂÇôÂ•Ω‰∫ÜÂóéÔºüüèÅ', 'Âä†Ê≤πÔºÅüçÄ', '‰Ω†ÂèØ‰ª•ÁöÑÔºÅüí´']
            },
            complete: {
                en: ['You\'re awesome! üéä', 'Champion! üèÜ', 'Superstar! ‚≠ê', 'Brilliant! üíé'],
                zh: ['‰Ω†Â§™Ê£í‰∫ÜÔºÅüéä', 'ÂÜ†ËªçÔºÅüèÜ', 'Ë∂ÖÁ¥öÂ∑®ÊòüÔºÅ‚≠ê', 'Â§™ËÅ∞Êòé‰∫ÜÔºÅüíé']
            }
        };

        function setPandaState(state, message = '') {
            const panda = document.getElementById('panda');
            const speech = document.getElementById('pandaSpeech');
            
            // Remove all state classes
            panda.classList.remove('happy', 'sad', 'thinking', 'celebrate');
            
            // Add new state
            panda.classList.add(state);
            
            // Show message if provided
            if (message) {
                speech.textContent = message;
                speech.classList.add('show');
                
                if (pandaSpeechTimeout) clearTimeout(pandaSpeechTimeout);
                pandaSpeechTimeout = setTimeout(() => {
                    speech.classList.remove('show');
                }, 2000);
            }
        }

        function getRandomMessage(category) {
            const messages = pandaMessages[category][currentLanguage];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        // Translations
        const translations = {
            en: {
                welcomeTitle: 'Learn to Read Time',
                welcomeSubtitle: 'Â≠∏ÁøíÁúãÊôÇÈêò',
                startGameBtn: 'START GAME',
                instructionsTitle: 'How to Play',
                inst1Title: 'Choose the Correct Time',
                inst1Desc: 'Look at the clock and select the correct time from 4 options',
                inst2Title: 'Beat the Timer',
                inst2Desc: 'Answer as many questions as you can before time runs out!',
                inst3Title: 'Earn Credits',
                inst3Desc: 'Get 10 credits for each correct answer. Use credits to unlock new clock styles!',
                inst4Title: 'Level Up',
                inst4Desc: 'Complete 10 questions to finish a level and earn bonus credits!',
                inst5Title: 'Panda Friend',
                inst5Desc: 'Watch the panda! It celebrates when you\'re correct and encourages you when wrong!',
                continueBtn: 'CONTINUE',
                menuTitle: 'Main Menu',
                creditsLabel: 'Credits',
                levelLabel: 'Level',
                scoreLabel: 'Best Score',
                classicClock: 'Classic Clock',
                digitalClock: 'Digital Clock',
                colorfulClock: 'Colorful Clock',
                modernClock: 'Modern Clock',
                backToWelcome: 'Back to Welcome',
                gameInstruction: 'Please choose the correct time',
                endGameBtn: 'End Game',
                levelComplete: 'Level Complete!',
                timeUp: 'Time\'s Up!',
                questionsCorrect: 'You answered {correct}/{total} questions correctly!',
                creditsEarned: '+{credits} Credits Earned! üåü',
                celebrationContinue: 'CONTINUE',
                unlockSuccess: 'Clock Style Unlocked!',
                notEnoughCredits: 'Not enough credits!',
                needCredits: 'You need {credits} more credits'
            },
            zh: {
                welcomeTitle: 'Â≠∏ÁøíÁúãÊôÇÈêò',
                welcomeSubtitle: 'Learn to Read Time',
                startGameBtn: 'ÈñãÂßãÈÅäÊà≤',
                instructionsTitle: 'ÈÅäÊà≤Ë™™Êòé',
                inst1Title: 'ÈÅ∏ÊìáÊ≠£Á¢∫ÊôÇÈñì',
                inst1Desc: 'ÁúãÊôÇÈêò‰∏¶Âæû4ÂÄãÈÅ∏È†Ö‰∏≠ÈÅ∏ÊìáÊ≠£Á¢∫ÁöÑÊôÇÈñì',
                inst2Title: 'ÊåëÊà∞Ë®àÊôÇ',
                inst2Desc: 'Âú®ÊôÇÈñìÁî®ÂÆå‰πãÂâçÁõ°ÂèØËÉΩÂõûÁ≠îÊõ¥Â§öÂïèÈ°åÔºÅ',
                inst3Title: 'Ë≥∫ÂèñÁ©çÂàÜ',
                inst3Desc: 'ÊØèÁ≠îÂ∞ç‰∏ÄÈ°åÁç≤Âæó10Á©çÂàÜ„ÄÇ‰ΩøÁî®Á©çÂàÜËß£ÈéñÊñ∞ÁöÑÊôÇÈêòÊ®£ÂºèÔºÅ',
                inst4Title: 'ÂçáÁ¥ö',
                inst4Desc: 'ÂÆåÊàê10È°åÈÄöÈÅéÈóúÂç°‰∏¶Áç≤ÂæóÈ°çÂ§ñÁ©çÂàÜÔºÅ',
                inst5Title: 'ÁÜäË≤ìÂ§•‰º¥',
                inst5Desc: 'Ê≥®ÊÑèÁÜäË≤ìÔºÅÁ≠îÂ∞çÊôÇÂÆÉÊúÉÊÖ∂Á•ùÔºåÁ≠îÈåØÊôÇÂÆÉÊúÉÈºìÂãµ‰Ω†ÔºÅ',
                continueBtn: 'ÁπºÁ∫å',
                menuTitle: '‰∏ªÈÅ∏ÂñÆ',
                creditsLabel: 'Á©çÂàÜ',
                levelLabel: 'Á≠âÁ¥ö',
                scoreLabel: 'ÊúÄÈ´òÂàÜ',
                classicClock: 'Á∂ìÂÖ∏ÊôÇÈêò',
                digitalClock: 'Êï∏‰ΩçÊôÇÈêò',
                colorfulClock: 'ÂΩ©Ëâ≤ÊôÇÈêò',
                modernClock: 'Áèæ‰ª£ÊôÇÈêò',
                backToWelcome: 'ËøîÂõûÊ≠°ËøéÈ†Å',
                gameInstruction: 'Ë´ãÈÅ∏ÊìáÊ≠£Á¢∫ÁöÑÊôÇÈñì',
                endGameBtn: 'ÁµêÊùüÈÅäÊà≤',
                levelComplete: 'ÈóúÂç°ÂÆåÊàêÔºÅ',
                timeUp: 'ÊôÇÈñìÂà∞ÔºÅ',
                questionsCorrect: '‰Ω†Á≠îÂ∞ç‰∫Ü {correct}/{total} È°åÔºÅ',
                creditsEarned: 'Áç≤Âæó {credits} Á©çÂàÜÔºÅüåü',
                celebrationContinue: 'ÁπºÁ∫å',
                unlockSuccess: 'ÊôÇÈêòÊ®£ÂºèÂ∑≤Ëß£ÈéñÔºÅ',
                notEnoughCredits: 'Á©çÂàÜ‰∏çË∂≥ÔºÅ',
                needCredits: 'ÈÇÑÈúÄË¶Å {credits} Á©çÂàÜ'
            }
        };

        function t(key) {
            return translations[currentLanguage][key] || key;
        }

        function updateTranslations() {
            document.getElementById('welcomeTitle').textContent = t('welcomeTitle');
            document.getElementById('welcomeSubtitle').textContent = t('welcomeSubtitle');
            document.getElementById('startGameBtn').textContent = t('startGameBtn');
            document.getElementById('instructionsTitle').textContent = t('instructionsTitle');
            document.getElementById('inst1Title').textContent = t('inst1Title');
            document.getElementById('inst1Desc').textContent = t('inst1Desc');
            document.getElementById('inst2Title').textContent = t('inst2Title');
            document.getElementById('inst2Desc').textContent = t('inst2Desc');
            document.getElementById('inst3Title').textContent = t('inst3Title');
            document.getElementById('inst3Desc').textContent = t('inst3Desc');
            document.getElementById('inst4Title').textContent = t('inst4Title');
            document.getElementById('inst4Desc').textContent = t('inst4Desc');
            document.getElementById('inst5Title').textContent = t('inst5Title');
            document.getElementById('inst5Desc').textContent = t('inst5Desc');
            document.getElementById('continueBtn').textContent = t('continueBtn');
            document.getElementById('menuTitle').textContent = t('menuTitle');
            document.getElementById('creditsLabel').textContent = t('creditsLabel');
            document.getElementById('levelLabel').textContent = t('levelLabel');
            document.getElementById('scoreLabel').textContent = t('scoreLabel');
            document.getElementById('classicClock').textContent = t('classicClock');
            document.getElementById('digitalClock').textContent = t('digitalClock');
            document.getElementById('colorfulClock').textContent = t('colorfulClock');
            document.getElementById('modernClock').textContent = t('modernClock');
            document.getElementById('backToWelcome').textContent = t('backToWelcome');
            document.getElementById('gameInstruction').textContent = t('gameInstruction');
            document.getElementById('endGameBtn').textContent = t('endGameBtn');
            document.getElementById('celebrationContinue').textContent = t('celebrationContinue');
        }

        function selectLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            updateTranslations();
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function showWelcome() {
            showScreen('welcomeScreen');
            setPandaState('thinking');
        }

        function showInstructions() {
            showScreen('instructionsScreen');
            setPandaState('thinking');
        }

        function showMenu() {
            showScreen('menuScreen');
            updateStatsDisplay();
            updateUnlockedStyles();
            setPandaState('thinking');
        }

        function updateStatsDisplay() {
            document.getElementById('totalCredits').textContent = playerCredits;
            document.getElementById('currentLevel').textContent = playerLevel;
            document.getElementById('highScore').textContent = playerHighScore;
        }

        function updateUnlockedStyles() {
            const styles = ['digital', 'colorful', 'modern'];
            
            styles.forEach(style => {
                const card = document.getElementById(style + 'Card');
                if (unlockedStyles.includes(style)) {
                    card.classList.remove('locked');
                    card.querySelector('.lock-icon')?.remove();
                    card.querySelector('.unlock-cost')?.remove();
                    card.onclick = () => startGame(style);
                }
            });
        }

        function unlockStyle(style, cost) {
            if (unlockedStyles.includes(style)) {
                startGame(style);
                return;
            }

            if (playerCredits >= cost) {
                playerCredits -= cost;
                unlockedStyles.push(style);
                playSound('unlock');
                setPandaState('celebrate', t('unlockSuccess'));
                updateStatsDisplay();
                updateUnlockedStyles();
            } else {
                playSound('wrong');
                const needed = cost - playerCredits;
                setPandaState('sad', t('notEnoughCredits'));
                alert(t('notEnoughCredits') + '\n' + t('needCredits').replace('{credits}', needed));
            }
        }

        function startGame(style) {
            currentStyle = style;
            currentQuestions = 0;
            correctAnswers = 0;
            sessionCredits = 0;
            gameTimer = 60;
            
            showScreen('gameScreen');
            initGameClock();
            generateQuestion();
            startTimer();
            setPandaState('thinking', getRandomMessage('start'));
        }

        function startTimer() {
            if (gameTimerInterval) clearInterval(gameTimerInterval);
            
            gameTimerInterval = setInterval(() => {
                gameTimer--;
                const timerEl = document.getElementById('gameTimer');
                timerEl.textContent = gameTimer;
                
                if (gameTimer <= 10) {
                    timerEl.classList.add('warning');
                }
                
                if (gameTimer <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function createClockFace(containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            for (let i = 0; i < 60; i++) {
                const tick = document.createElement('div');
                tick.className = i % 5 === 0 ? 'tick major' : 'tick';
                tick.style.transform = `rotate(${i * 6}deg)`;
                container.appendChild(tick);
            }

            for (let i = 1; i <= 12; i++) {
                const number = document.createElement('div');
                number.className = 'number';
                number.textContent = i;
                const angle = (i * 30 - 90) * Math.PI / 180;
                const radius = 115;
                number.style.left = `${150 + radius * Math.cos(angle) - 10}px`;
                number.style.top = `${150 + radius * Math.sin(angle) - 15}px`;
                container.appendChild(number);
            }

            const hourHand = document.createElement('div');
            hourHand.className = 'hour-hand';
            hourHand.id = containerId + 'HourHand';
            container.appendChild(hourHand);

            const minuteHand = document.createElement('div');
            minuteHand.className = 'minute-hand';
            minuteHand.id = containerId + 'MinuteHand';
            container.appendChild(minuteHand);

            const center = document.createElement('div');
            center.className = 'clock-center';
            container.appendChild(center);
        }

        function setClockTime(containerId, hours, minutes) {
            const hourHand = document.getElementById(containerId + 'HourHand');
            const minuteHand = document.getElementById(containerId + 'MinuteHand');
            
            const hourDegrees = (hours % 12) * 30 + (minutes / 60) * 30;
            const minuteDegrees = minutes * 6;

            hourHand.style.transform = `rotate(${hourDegrees}deg)`;
            minuteHand.style.transform = `rotate(${minuteDegrees}deg)`;
        }

        function initGameClock() {
            const clockContainer = document.getElementById('gameClock');
            clockContainer.className = 'clock-container style-' + currentStyle;
            createClockFace('gameClockFace');
        }

        function generateQuestion() {
            if (currentQuestions >= 10) {
                completeLevelWithStyle();
                return;
            }

            const hours = Math.floor(Math.random() * 12) + 1;
            const minutes = Math.floor(Math.random() * 12) * 5;
            currentAnswer = `${hours}:${minutes.toString().padStart(2, '0')}`;
            
            setClockTime('gameClockFace', hours, minutes);

            const options = [currentAnswer];
            while (options.length < 4) {
                const h = Math.floor(Math.random() * 12) + 1;
                const m = Math.floor(Math.random() * 12) * 5;
                const option = `${h}:${m.toString().padStart(2, '0')}`;
                if (!options.includes(option)) {
                    options.push(option);
                }
            }

            options.sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('gameOptions');
            optionsContainer.innerHTML = '';
            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option;
                btn.onclick = () => checkAnswer(option, btn);
                optionsContainer.appendChild(btn);
            });

            updateGameProgress();
        }

        function checkAnswer(selected, btn) {
            const allButtons = document.querySelectorAll('.option-btn');
            allButtons.forEach(b => b.style.pointerEvents = 'none');

            currentQuestions++;

            if (selected === currentAnswer) {
                btn.classList.add('correct');
                correctAnswers++;
                sessionCredits += 10;
                playSound('correct');
                setPandaState('happy', getRandomMessage('correct'));
            } else {
                btn.classList.add('wrong');
                playSound('wrong');
                setPandaState('sad', getRandomMessage('wrong'));
                allButtons.forEach(b => {
                    if (b.textContent === currentAnswer) {
                        b.classList.add('correct');
                    }
                });
            }

            document.getElementById('gameCredits').textContent = sessionCredits;

            setTimeout(() => {
                generateQuestion();
                setPandaState('thinking');
            }, 1500);
        }

        function updateGameProgress() {
            const progress = (currentQuestions / 10) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('questionCounter').textContent = currentQuestions + '/10';
            document.getElementById('gameLevelText').textContent = `${currentLanguage === 'en' ? 'Level' : 'Á≠âÁ¥ö'} ${playerLevel}`;
        }

        function completeLevelWithStyle() {
            clearInterval(gameTimerInterval);
            
            // Calculate bonus
            const timeBonus = Math.floor(gameTimer / 2);
            const levelBonus = playerLevel * 10;
            const totalEarned = sessionCredits + timeBonus + levelBonus;
            
            playerCredits += totalEarned;
            if (correctAnswers > playerHighScore) {
                playerHighScore = correctAnswers;
            }
            playerLevel++;

            // Show celebration
            showCelebration(correctAnswers, totalEarned);
            createConfetti();
            playSound('celebration');
            setPandaState('celebrate', getRandomMessage('complete'));
        }

        function showCelebration(correct, credits) {
            const overlay = document.getElementById('celebrationOverlay');
            const emoji = document.getElementById('celebrationEmoji');
            const text = document.getElementById('celebrationText');
            const stats = document.getElementById('celebrationStats');
            const reward = document.getElementById('rewardEarned');

            if (correct === 10) {
                emoji.textContent = 'üèÜ';
                text.textContent = t('levelComplete');
            } else {
                emoji.textContent = '‚è∞';
                text.textContent = t('timeUp');
            }

            stats.textContent = t('questionsCorrect').replace('{correct}', correct).replace('{total}', 10);
            reward.textContent = t('creditsEarned').replace('{credits}', credits);

            overlay.classList.add('active');
        }

        function closeCelebration() {
            document.getElementById('celebrationOverlay').classList.remove('active');
            showMenu();
        }

        function createConfetti() {
            const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dfe6e9', '#74b9ff'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        function endGame() {
            clearInterval(gameTimerInterval);
            
            // Award partial credits
            playerCredits += sessionCredits;
            if (correctAnswers > playerHighScore) {
                playerHighScore = correctAnswers;
            }
            
            showMenu();
        }

        // Load saved data
        window.onload = function() {
            const savedData = localStorage.getItem('clockGameData');
            if (savedData) {
                const data = JSON.parse(savedData);
                playerCredits = data.credits || 0;
                playerLevel = data.level || 1;
                playerHighScore = data.highScore || 0;
                unlockedStyles = data.unlockedStyles || ['classic'];
            }
            updateTranslations();
            setPandaState('thinking');
        };

        // Save data periodically
        setInterval(() => {
            const data = {
                credits: playerCredits,
                level: playerLevel,
                highScore: playerHighScore,
                unlockedStyles: unlockedStyles
            };
            localStorage.setItem('clockGameData', JSON.stringify(data));
        }, 5000);

        // Panda click interaction
        document.getElementById('panda').addEventListener('click', () => {
            setPandaState('celebrate', currentLanguage === 'en' ? 'Hi there! üëã' : '‰Ω†Â•ΩÔºÅüëã');
        });
    </script>
</body>
</html>